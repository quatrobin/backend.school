# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Elasticsearch –≤ School API

## ‚úÖ –£—Å–ø–µ—à–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

Elasticsearch —É—Å–ø–µ—à–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –ø—Ä–æ–µ–∫—Ç School API!

### –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

1. **–î–æ–±–∞–≤–ª–µ–Ω Elasticsearch –≤ Docker Compose**
   - –í–µ—Ä—Å–∏—è: 7.17.0
   - –ü–æ—Ä—Ç: 9200 (HTTP), 9300 (Transport)
   - –†–µ–∂–∏–º: single-node
   - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –æ—Ç–∫–ª—é—á–µ–Ω–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

2. **–î–æ–±–∞–≤–ª–µ–Ω—ã NuGet –ø–∞–∫–µ—Ç—ã**
   - NEST 7.17.0
   - Elasticsearch.Net 7.17.0

3. **–°–æ–∑–¥–∞–Ω —Å–µ—Ä–≤–∏—Å Elasticsearch**
   - `IElasticsearchService` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
   - `ElasticsearchService` - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø—Ä–∏ CRUD –æ–ø–µ—Ä–∞—Ü–∏—è—Ö

4. **–°–æ–∑–¥–∞–Ω –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø–æ–∏—Å–∫–∞**
   - –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –∏–Ω–¥–µ–∫—Å–∞–º
   - –ü–æ–∏—Å–∫ –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
   - –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤

5. **–û–±–Ω–æ–≤–ª–µ–Ω BookService**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ –∫–Ω–∏–≥

## üöÄ –ó–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
curl http://localhost:9200
curl http://localhost:3000/api/search/status
```

## üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ endpoints

### –ü–æ–∏—Å–∫
- `GET /api/search/global?query=–ø–æ–∏—Å–∫–æ–≤—ã–π_–∑–∞–ø—Ä–æ—Å` - –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫
- `GET /api/search/{indexName}?query=–ø–æ–∏—Å–∫–æ–≤—ã–π_–∑–∞–ø—Ä–æ—Å` - –ø–æ–∏—Å–∫ –ø–æ –∏–Ω–¥–µ–∫—Å—É
- `GET /api/search/status` - —Å—Ç–∞—Ç—É—Å Elasticsearch
- `POST /api/search/setup` - —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ (Admin)

### –ò–Ω–¥–µ–∫—Å—ã
- `users` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `courses` - –∫—É—Ä—Å—ã  
- `books` - –∫–Ω–∏–≥–∏
- `lessons` - —É—Ä–æ–∫–∏
- `assignments` - –∑–∞–¥–∞–Ω–∏—è

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Docker Compose
```yaml
elasticsearch:
  image: elasticsearch:7.17.0
  ports:
    - "9200:9200"
    - "9300:9300"
  environment:
    - discovery.type=single-node
    - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
    - xpack.security.enabled=false
```

### appsettings.json
```json
{
  "Elasticsearch": {
    "Url": "http://localhost:9200",
    "DefaultIndex": "school"
  }
}
```

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
curl http://localhost:3000/api/search/status
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
```bash
curl -X POST http://localhost:3000/api/search/setup \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

### –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫
```bash
curl "http://localhost:3000/api/search/global?query=–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é –≤ –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã**
   - CourseService
   - LessonService  
   - UserService
   - AssignmentService

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Kibana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏**
   ```yaml
   kibana:
     image: kibana:7.17.0
     ports:
       - "5601:5601"
   ```

3. **–î–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã**
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–∞–º
   - –ê–≥—Ä–µ–≥–∞—Ü–∏–∏
   - –§–∞—Å–µ—Ç–Ω—ã–π –ø–æ–∏—Å–∫

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- Elasticsearch: http://localhost:9200
- API: http://localhost:3000
- –ò–Ω–¥–µ–∫—Å—ã: `curl http://localhost:9200/_cat/indices`

## ‚úÖ –°—Ç–∞—Ç—É—Å

- ‚úÖ Elasticsearch –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ API –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ Elasticsearch
- ‚úÖ –ë–∞–∑–æ–≤—ã–π –ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∫–Ω–∏–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- ‚è≥ –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã —Ç—Ä–µ–±—É—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è 