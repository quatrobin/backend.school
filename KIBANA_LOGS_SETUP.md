# üìä –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Kibana –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–≥–æ–≤

## üéØ –¶–µ–ª—å

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Kibana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è School API, –∫–æ—Ç–æ—Ä—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Elasticsearch.

## üîß –ß—Ç–æ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

### ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- **Serilog** –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–æ–≥–æ–≤ –≤ Elasticsearch
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è** –ª–æ–≥–æ–≤ –≤ `school-logs-YYYY.MM.DD`

### ‚úÖ Elasticsearch
- **–®–∞–±–ª–æ–Ω –∏–Ω–¥–µ–∫—Å–∞** `school-logs` —Å–æ–∑–¥–∞–Ω
- **–ú–∞–ø–ø–∏–Ω–≥ –ø–æ–ª–µ–π** –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ª–æ–≥–æ–≤
- **–ò–Ω–¥–µ–∫—Å –¥–ª—è —Å–µ–≥–æ–¥–Ω—è** `school-logs-2025.08.02` —Å–æ–∑–¥–∞–Ω

### ‚úÖ Kibana
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** `kibana.yml` –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä** –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 5601

## üöÄ –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Kibana

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ Kibana
```
http://localhost:5601
```

### 2. –°–æ–∑–¥–∞–π—Ç–µ Index Pattern

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Stack Management** ‚Üí **Index Patterns**
2. –ù–∞–∂–º–∏—Ç–µ **Create index pattern**
3. –í–≤–µ–¥–∏—Ç–µ **Index pattern name**: `school-logs-*`
4. –ù–∞–∂–º–∏—Ç–µ **Next step**
5. –í—ã–±–µ—Ä–∏—Ç–µ **Time field**: `@timestamp`
6. –ù–∞–∂–º–∏—Ç–µ **Create index pattern**

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Discover –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Discover**
2. –í—ã–±–µ—Ä–∏—Ç–µ **Index pattern**: `school-logs-*`
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ **Time range** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞)
4. –ù–∞–∂–º–∏—Ç–µ **Refresh**

### 4. –°–æ–∑–¥–∞–π—Ç–µ –¥–∞—à–±–æ—Ä–¥

#### 4.1 –°–æ–∑–¥–∞–π—Ç–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é "Logs Overview"

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Visualize Library**
2. –ù–∞–∂–º–∏—Ç–µ **Create visualization**
3. –í—ã–±–µ—Ä–∏—Ç–µ **Data Table**
4. –í—ã–±–µ—Ä–∏—Ç–µ **Index pattern**: `school-logs-*`
5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–µ—Ç—Ä–∏–∫–∏:
   - **Metric**: Count
   - **Bucket**: Split Rows
   - **Aggregation**: Terms
   - **Field**: `level` (–∏–ª–∏ `level.raw` –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
6. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ "Log Levels"

#### 4.2 –°–æ–∑–¥–∞–π—Ç–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é "Elasticsearch Operations"

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é **Data Table**
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–µ—Ç—Ä–∏–∫–∏:
   - **Metric**: Count
   - **Bucket**: Split Rows
   - **Aggregation**: Terms
   - **Field**: `message` (–∏–ª–∏ `message.raw` –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
   - **Filter**: `message: "–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è" OR message: "–ü–æ–∏—Å–∫" OR message: "–£–¥–∞–ª–µ–Ω–∏–µ"`
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ "ES Operations"

#### 4.3 –°–æ–∑–¥–∞–π—Ç–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é "API Requests"

1. –°–æ–∑–¥–∞–π—Ç–µ **Line Chart**
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ:
   - **Y-axis**: Count
   - **X-axis**: Date Histogram
   - **Field**: `@timestamp`
   - **Filter**: `message: "–ó–∞–ø—Ä–æ—Å"`
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ "API Requests Over Time"

#### 4.4 –°–æ–∑–¥–∞–π—Ç–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é "Errors"

1. –°–æ–∑–¥–∞–π—Ç–µ **Pie Chart**
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ:
   - **Slice Size**: Count
   - **Slice Size**: Terms
   - **Field**: `message` (–∏–ª–∏ `message.raw` –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
   - **Filter**: `level: "Error"`
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ "Error Types"

### 5. –°–æ–∑–¥–∞–π—Ç–µ –¥–∞—à–±–æ—Ä–¥

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Dashboard**
2. –ù–∞–∂–º–∏—Ç–µ **Create dashboard**
3. –î–æ–±–∞–≤—å—Ç–µ –≤—Å–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:
   - Log Levels
   - ES Operations
   - API Requests Over Time
   - Error Types
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ "School API Logs Dashboard"

## üìä –ü–æ–ª–µ–∑–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è Discover

### –í—Å–µ –ª–æ–≥–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
```
@timestamp:[now-1h TO now]
```

### –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
```
level: "Error"
```

### –õ–æ–≥–∏ Elasticsearch –æ–ø–µ—Ä–∞—Ü–∏–π
```
message: "–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è" OR message: "–ü–æ–∏—Å–∫" OR message: "–£–¥–∞–ª–µ–Ω–∏–µ"
```

### –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–Ω–∏–≥–∏
```
BookId: 1
```

### –õ–æ–≥–∏ –ø–æ–∏—Å–∫–∞
```
SearchTerm: "–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ"
```

### –õ–æ–≥–∏ API –∑–∞–ø—Ä–æ—Å–æ–≤
```
message: "–ó–∞–ø—Ä–æ—Å"
```

## üîç –ö–∞–∫ –Ω–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π

### 1. –í Discover
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Discover**
2. –í—ã–±–µ—Ä–∏—Ç–µ **Index pattern**: `school-logs-*`
3. –í –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏ –Ω–∞–∂–º–∏—Ç–µ **Add** —Ä—è–¥–æ–º —Å –ø–æ–ª–µ–º
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è –≤ —Å–ø–∏—Å–∫–µ

### 2. –í Index Pattern
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Stack Management** ‚Üí **Index Patterns**
2. –í—ã–±–µ—Ä–∏—Ç–µ `school-logs-*`
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Å–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π –∏ –∏—Ö —Ç–∏–ø—ã

### 3. –ß–µ—Ä–µ–∑ Elasticsearch API
```bash
# –ü–æ–ª—É—á–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥ –∏–Ω–¥–µ–∫—Å–∞
curl "http://localhost:9200/school-logs-$(date +%Y.%m.%d)/_mapping" | jq .
```

## üé® –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞

### –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ –¥–ª—è —É—Ä–æ–≤–Ω–µ–π –ª–æ–≥–æ–≤
- **Information**: –ó–µ–ª–µ–Ω—ã–π
- **Warning**: –ñ–µ–ª—Ç—ã–π  
- **Error**: –ö—Ä–∞—Å–Ω—ã–π
- **Debug**: –°–∏–Ω–∏–π

### –ü–æ–ª–µ–∑–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `@timestamp` - –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è
- `level` - —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- `message` - —Å–æ–æ–±—â–µ–Ω–∏–µ
- `IndexName` - –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ Elasticsearch
- `DocumentType` - —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `BookId`, `BookTitle` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–Ω–∏–≥–∞—Ö
- `SearchTerm`, `Query` - –ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- `Count`, `TotalResults` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### 1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Auto-refresh
1. –í **Discover** –Ω–∞–∂–º–∏—Ç–µ **Auto-refresh**
2. –í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10 —Å–µ–∫—É–Ω–¥)

### 2. –°–æ–∑–¥–∞–π—Ç–µ –∞–ª–µ—Ä—Ç—ã
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Stack Management** ‚Üí **Rules and Alerts**
2. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
1. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ API
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –õ–æ–≥–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏–Ω–¥–µ–∫—Å —Å–æ–∑–¥–∞–Ω: `curl http://localhost:9200/_cat/indices`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —à–∞–±–ª–æ–Ω: `curl http://localhost:9200/_template/school-logs`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: `docker-compose logs webapi`

### Kibana –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Elasticsearch
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å Elasticsearch: `curl http://localhost:9200`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Kibana: `docker-compose logs kibana`

### –ü–æ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–∞–ø–ø–∏–Ω–≥ –∏–Ω–¥–µ–∫—Å–∞: `curl "http://localhost:9200/school-logs-$(date +%Y.%m.%d)/_mapping"`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ª–æ–≥–∏ –∑–∞–ø–∏—Å–∞–ª–∏—Å—å: `curl "http://localhost:9200/school-logs-$(date +%Y.%m.%d)/_count"`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Index Pattern —Å–æ–∑–¥–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –õ–æ–≥–∏ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Elasticsearch
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Serilog –≤ `appsettings.json`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Elasticsearch –≤ –∫–æ–¥–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –æ—à–∏–±–∫–∏

## üìà –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π
- **Heat Map** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- **Tag Cloud** –¥–ª—è —á–∞—Å—Ç—ã—Ö –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **Gauge** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
- –ê–ª–µ—Ä—Ç –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ—à–∏–±–æ–∫
- –ê–ª–µ—Ä—Ç –ø—Ä–∏ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
- –ê–ª–µ—Ä—Ç –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Elasticsearch

### 3. –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ –≤ CSV
- –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É –≤–∞—Å –±—É–¥–µ—Ç:
- ‚úÖ **–î–∞—à–±–æ—Ä–¥ –ª–æ–≥–æ–≤** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** API
- ‚úÖ **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫** –∏ –ø—Ä–æ–±–ª–µ–º
- ‚úÖ **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** Elasticsearch

**Kibana –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ª–æ–≥–æ–≤!** üöÄ 